[![DOI](https://zenodo.org/badge/496952863.svg)](https://zenodo.org/badge/latestdoi/496952863)

# PredictCovidOpen

This project contain the code used for the preprint [Ferté, Thomas and Jouhet, Vianney and Griffier, Romain and Hejblum, Boris P. and Thiébaut, Rodolphe and crisis Task, Bordeaux University Hospital Covid-19, The Benefit of Augmenting Open Data with Clinical Data-Warehouse EHR for Forecasting SARS-CoV-2 Hospitalizations in Bordeaux Area, France.](http://dx.doi.org/10.2139/ssrn.4071506)

## Structure

The project is organized as a R package. The analysis code is located in the reporting folder and uses the functions from the package located in the R folder. The intermediate results and the data used for the analysis are located in the extdata folder whereas the data needed by the functions are located in the data folder.

### Reporting folder

In the reporting folder, the publication_journey folder contain the scripts used for the analysis.

#### 00_importData.R

Script to import the data. The first part importing the data from i2b2 will not work (access to the CHU de Bordeaux datawarehouse is required). The second part imports data from public sources and the last part clean, organise and save the data. The final saved file is not included in the repo (too large) but will be deposited on dryad.

#### 01_data_management.R

This file set the hyperparameters used for comparison. It defines the different scenarios where performance will be compared regarding the data used, the smoothing, the feature engineering, etc. The final file of the hyperparameters is in the extdata repository.

#### 02_curta_scripts

This folder contain the different scripts of the analysis.

- 02_curta_multistep corresponds to the main_analysis.
- 02_eds_vs_noeds compares the results with and without EHRs data.
- 02_frechet_rf compute the performance for Frechet random forest.
- 02_interaction explores the information added by the interactions.

The script use the [MCIA (Mésocentre de Calcul Intensif Aquitain)](https://www.mcia.fr/)

#### 03_merge_results

This folder contain the scripts to merge the results obtained by the computation performed at step 02.

#### 04_reporting

Corresponds to the statistical report.

- reporting_article_precompute.R perform the heavy computations to present the results.
- reporting_article.Rmd organise the results and save figures. The output of this file are the corresponding md file and folder. Also, the figure used in the publication process are savec in the figures_pdf folder.

### extdata folder

Because huge files should not be deposited on github, we chose to deposit only the lsHyperparamPublication.rds file which contains the hyperparameters generated by 01_data_management.R file. File containing the data will be deposited on dryad.
